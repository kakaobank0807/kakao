<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="trade">
<select id="totalCount" resultType="Integer">
		SELECT COUNT(tno) FROM trade
</select>
<select id="tradeList" parameterType="Map" resultType="Map">
SELECT 
t1.tno AS tno,
t1.ttime AS ttime,
t1.toaccount AS toaccount,
t1.tipaccount AS tipaccount,
FORMAT(m1.mmoney, '#,#') as mmoney,
m1.mid AS ti,
m1.mname AS tname,  
m2.mid AS tipid,
m2.mname AS tipname,
FORMAT(t1.tmoney, '#,#')AS tmoney 
FROM trade t1 JOIN members m1 ON t1.tono = m1.mno 
                  JOIN members m2 ON t1.tipno = m2.mno
WHERE m1.mid = "${mid}" OR m2.mid = "${mid}"
ORDER BY tno DESC
LIMIT #{firstRecordIndex }, #{recordCountPerPage };
</select>
<select id="tradeMem"  parameterType="Map" resultType="Map">
 SELECT * FROM members WHERE mid = "${mid}" 
</select>

</mapper>
